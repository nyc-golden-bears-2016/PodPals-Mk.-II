<%= image_tag @user.avatar.url(:square) %>

<h3><%= @user.username %><h3>
<% if user_signed_in? %>
	<% unless @user == current_user || current_user.friends.include?(@user) || current_user.pending_friends.include?(@user) || current_user.inverse_friends.include?(@user) || current_user.inverse_pending_friends.include?(@user) %>
		<%= form_for(:friendships, :url => user_friends_path(:user_id => current_user.id, :friend_id => @user.id)) do |f| %>
			<%= f.submit "Add to My Friends" %>
		<% end %>
	<% end %>
<% end %>
<h3>In Queue</h3>
	<% @sorted_queue_genres.each do |genre_group| %>
		<h3><%= genre_group.first.genre %></h3><br>
			<% genre_group.each do |podcast| %>
			<img src="<%= podcast.image100 %>">
			<li><%= link_to podcast.title, podcast%><br>
					<%= podcast.artist %></li><br>
					<% if user_signed_in? && (@user.friends.include?(current_user) || @user.inverse_friends.include?(current_user)) %>
					<%= form_for(@like) do |f| %>
					  <%= f.hidden_field(:user_id, :value => current_user.id) %>
					  <%= f.hidden_field(:likeable_id, :value => podcast.id) %>
					  <%= f.hidden_field(:likeable_type, :value => podcast.class.name) %>
					  <%= f.submit "LIKE" %>
					<% end %>
					<% end %>
					<% if @user == current_user %>
					<%= link_to "Remove from queue", "/podcastusers/#{PodcastUser.find_by(user_id: @user.id, podcast_id: podcast.id).id}", :method => 'delete' %>
					<% end %>
			<% end %>
	<% end %>
<h3>Favorites</h3>
	<% @sorted_favorite_genres.each do |genre_group| %>
	<h3><%= genre_group.first.genre %></h3><br>
			<% genre_group.each do |podcast| %>
			<img src="<%= podcast.image100 %>">
			<li><%= link_to podcast.title, podcast%><br>
					<%= podcast.artist %></li>
					<%= podcast.likes.count %>
					<% if user_signed_in? && (@user.friends.include?(current_user) || @user.inverse_friends.include?(current_user)) %>
					<%= form_for(@like) do |f| %>
					  <%= f.hidden_field(:user_id, :value => current_user.id) %>
					  <%= f.hidden_field(:likeable_id, :value => podcast.id) %>
					  <%= f.hidden_field(:likeable_type, :value => podcast.class.name) %>
					  <%= f.submit "LIKE"%>
					<% end %>
					<% end %>
					<% if @user == current_user %>
					<%= link_to "Remove from favorites", "/podcastusers/#{PodcastUser.find_by(user_id: @user.id, podcast_id: podcast.id).id}", :method => 'delete' %>
					<% end %>
			<% end %>
	<% end %>
<h3>Recommendations</h3>
<% @suggestions.each do |recommendation| %>
	<% recommendation["results"].each do |results| %>
<br>
		<% unless @favoriteTitles.include?(results["collectionName"]) || @inQueueTitles.include?(results["collectionName"])%>
		<p><a href="<%= results["collectionViewUrl"]%>"><img src="<%= results["artworkUrl100"]%>"/></a></p>
		<p>Title: <%= results["collectionName"] %></p>
		<p>Artist: <%= results["artistName"] %></p>
		<br>
			<%= form_for(@podcast) do |f| %>
				<%= f.hidden_field(:title, :value => results["collectionName"]) %>
				<%= f.hidden_field(:genre, :value => results["primaryGenreName"]) %>
    		<%= f.hidden_field(:artist, :value => results["artistName"]) %>
    		<% fields_for @userPods do |u| %>
		    <%= u.hidden_field(:in_queue, :value => true) %>
		    <% end %>
		    <%= f.submit "Add to queue!" %>
			<% end %>
			<%= form_for(@podcast) do |f| %>
				<%= f.hidden_field(:title, :value => results["collectionName"]) %>
				<%= f.hidden_field(:genre, :value => results["primaryGenreName"]) %>
    		<%= f.hidden_field(:artist, :value => results["artistName"]) %>
    				<% fields_for @userPods do |u| %>
		    			<%= u.hidden_field(:in_queue, :value => true) %>
		    		<% end %>
		    		<%= f.submit "Add to favorites!" %>
		    	<% end %>
		<% end %>
	<% end %>
<% end %>

